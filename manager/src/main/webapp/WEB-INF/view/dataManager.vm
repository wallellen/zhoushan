<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  
	<script src="$!request.getContextPath()/public/bootstrap/js/bootstrap.min.js"></script>

	<!-- BEGIN:File Upload Plugin JS files-->
	<script src="$!request.getContextPath()/public/jquery-file-upload/js/vendor/jquery.ui.widget.js"></script>
	<!-- The Templates plugin is included to render the upload/download listings -->
	<script src="$!request.getContextPath()/public/jquery-file-upload/js/vendor/tmpl.min.js"></script>
	<!-- The Load Image plugin is included for the preview images and image resizing functionality -->
	<script src="$!request.getContextPath()/public/jquery-file-upload/js/vendor/load-image.min.js"></script>
	<!-- The Canvas to Blob plugin is included for image resizing functionality -->
	<script src="$!request.getContextPath()/public/jquery-file-upload/js/vendor/canvas-to-blob.min.js"></script>
	<!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
	<script src="$!request.getContextPath()/public/jquery-file-upload/js/jquery.iframe-transport.js"></script>
	<!-- The basic File Upload plugin -->
	<script src="$!request.getContextPath()/public/jquery-file-upload/js/jquery.fileupload.js"></script>
	<!-- The File Upload file processing plugin -->
	<script src="$!request.getContextPath()/public/jquery-file-upload/js/jquery.fileupload-fp.js"></script>
	<!-- The File Upload user interface plugin -->
	<script src="$!request.getContextPath()/public/jquery-file-upload/js/jquery.fileupload-ui.js"></script>
	
	<script src="$!request.getContextPath()/public/js/bootstrap-datetimepicker.min.js"></script>    
    <link href="$!request.getContextPath()/public/css/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen">
	<link href="$!request.getContextPath()/public/jquery-file-upload/css/jquery.fileupload-ui.css" rel="stylesheet" />
</head>

<body>
	<div class="portlet box green">
		
		<div class="portlet-title">
			<h4><i class="icon-reorder"></i>表单录入</h4>
			<div class="tools">
				<a href="javascript:;" class="collapse"></a>
			</div>
		</div>
		
		<div class="portlet-body">
        	<div class="row-fluid">
        		<h3 class="form-section">表单录入各环节数据</h3>
        		<!--BEGIN TABS-->
				<div class="tabbable tabbable-custom tabs-left">
					<!-- Only required for left/right tabs -->
					<ul class="nav nav-tabs tabs-left">
						<li class="active" ><a href="#tab_3_2" data-toggle="tab">录入运输数据</a></li>
						<li><a href="#tab_3_3" data-toggle="tab">录入销售数据</a></li>
					</ul>
					<div class="tab-content">
						<div class="tab-pane" id="tab_3_2">
							<!--hear is the form of trans data-->
							<div class="row-fluid">
                               <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="trans_driver">驾驶员</label>
                                     <div class="controls">
                                        <input type="text" id="trans_driver" class="m-wrap span12" placeholder="">
                                     </div>
                                  </div>
                               </div>
                               <!--/span-->
                               <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="trans_license">车辆或船只牌照</label>
                                     <div class="controls">
                                        <input type="text" id="trans_license" class="m-wrap span12" placeholder="">
                                     </div>
                                  </div>
                               </div>
                             </div>
                            <div class="row-fluid">
                                <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="trans_start_place">出发地点</label>
                                     <div class="controls">
                                        <input type="text" id="trans_start_place" class="m-wrap span12" placeholder="">
                                     </div>
                                  </div>
                                </div>
                               <!--/span-->
                               <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="trans_end_place">目的地点</label>
                                     <div class="controls">
                                        <input type="text" id="trans_end_place" class="m-wrap span12" placeholder="">
                                     </div>
                                  </div>
                               </div>
                               <!--/span-->
                            </div>  <!--row fluid is over-->

                            <div class="row-fluid">
                                <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="trans_start_time">出发时间</label>
                                     <div class="controls">
                                        <div id="trans_datetimepicker1" class="input-append date" >
                                        <input data-format="yyyy-MM-dd hh:mm:ss" class="m-wrap span12" type="text"  id ="trans_start_time"></input>
                                        <span class="add-on">
                                        <i data-time-icon="icon-time" data-date-icon="icon-calendar">
                                        </i>
                                        </span>
                                        </div>
                                   </div>
                                 </div>
                                </div>
                               <!--/span-->
                               <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="trans_end_time">到达时间</label>
                                     <div class="controls">
                                        <div id="trans_datetimepicker2" class="input-append date">
                                        <input data-format="yyyy-MM-dd hh:mm:ss" class="m-wrap span12" type="text"  id ="trans_end_time"></input>
                                        <span class="add-on">
                                        <i data-time-icon="icon-time" data-date-icon="icon-calendar">
                                        </i>
                                        </span>
                                     </div>
                                     </div>
                                  </div>
                               </div>
                               <!--/span-->
                            </div> 

                            <div  style="position:relative;float:right;">
                                <a class="btn purple big" id="submitTransData">提交运输数据<i class="m-icon-big-swapright m-icon-white"></i></a>
                            </div>
							<!--trans form is end-->
						</div>
						<div class="tab-pane active" id="tab_3_3">
							<!--here is the form of sale data-->
							<div class="row-fluid">
                               <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="sale_place">销售地区</label>
                                     <div class="controls">
                                        <input type="text" id="sale_place" class="m-wrap span12" placeholder="">
                                     </div>
                                  </div>
                               </div>
                               <!--/span-->
                               <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="sale_market">销售超市</label>
                                     <div class="controls">
                                        <input type="text" id="sale_market" class="m-wrap span12" placeholder="">
                                     </div>
                                  </div>
                               </div>
                             </div>
                            <div class="row-fluid">
                                 <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="sale_freezer_number">冰柜编号</label>
                                     <div class="controls">
                                        <input type="text" id="sale_freezer_number" class="m-wrap span12" placeholder="">
                                     </div>
                                 </div>
                                 </div>
                               <!--/span-->
                               <div class="span6 ">
                                  <div class="control-group">
                                     <label class="control-label" for="sale_time">上架时间</label>
                                     <div class="controls">
                                        <div id="sale_datetimepicker" class="input-append date">
                                        <input data-format="yyyy-MM-dd hh:mm:ss" class="m-wrap span12" type="text"  id ="sale_time"></input>
                                        <span class="add-on">
                                        <i data-time-icon="icon-time" data-date-icon="icon-calendar">
                                        </i>
                                        </span>
                                     </div>
                                     </div>
                                  </div>
                               </div>
                               <!--/span-->
                            </div> 

                            <div  style="position:relative;float:right;">
                                <a class="btn purple big" id="submitSaleData">提交销售数据<i class="m-icon-big-swapright m-icon-white"></i></a>
                            </div>
							<!--sale data is end-->
						</div>
					</div>
				</div>
				<!--END TABS-->   			
        	</div> <!--the portlet body's Row fluid end -->
		</div> <!--portlet-body end -->
	</div> <!--Portlet end -->

	<div class="portlet box green">
		
		<div class="portlet-title">
			<h4><i class="icon-reorder"></i>文件导入</h4>
			<div class="tools">
				<a href="javascript:;" class="collapse"></a>
			</div>
		</div>
		
		<div class="portlet-body">
        	<div class="row-fluid">
        		<h3 class="form-section">Excel导入各环节数据</h3>
        		<!-- The file upload form used as target for the file upload widget -->
				<form id="fileupload" action="" method="POST" enctype="multipart/form-data">
    			<!-- Redirect browsers with JavaScript disabled to the origin page -->
    			<noscript>
        			<input type="hidden" name="redirect" value="http://blueimp.github.com/jQuery-File-Upload/">
    			</noscript>
    			<!-- The fileupload-buttonbar contains buttons to add/delete files and start/cancel the upload -->
    			<div class="row-fluid fileupload-buttonbar">
        			<div class="span7">
            		<!-- The fileinput-button span is used to style the file input field as button -->
            		<span class="btn green fileinput-button">
                	<i class="icon-plus icon-white">
                	</i>
                	<span>
                    	Add files...
                	</span>
                	<input type="file" name="files[]" multiple>
           			</span>
            		<button type="submit" class="btn blue start">
                	<i class="icon-upload icon-white">
                	</i>
                	<span>
                    	Start upload
                	</span>
            		</button>
            		<button type="reset" class="btn yellow cancel">
                	<i class="icon-ban-circle icon-white">
                	</i>
                	<span>
                    	Cancel upload
                	</span>
            		</button>
            		<button type="button" class="btn red delete">
                	<i class="icon-trash icon-white">
                	</i>
                	<span>
                    	Delete
                	</span>
            		</button>
            		<input type="checkbox" class="toggle fileupload-toggle-checkbox">
        			</div>
        			<!-- The global progress information -->
        			<div class="span5 fileupload-progress fade">
           			<!-- The global progress bar -->
            		<div class="progress progress-success progress-striped active" role="progressbar"
            		aria-valuemin="0" aria-valuemax="100">
                	<div class="bar" style="width:0%;">
                	</div>
            		</div>
            		<!-- The extended global progress information -->
            		<div class="progress-extended">
                		&nbsp;
            		</div>
        			</div>
    			</div>
    			<!-- The loading indicator is shown during file processing -->
    			<div class="fileupload-loading"></div>
    			<br>
    			<!-- The table listing the files available for upload/download -->
    			<table role="presentation" class="table table-striped">
        		<tbody class="files" data-toggle="modal-gallery" data-target="#modal-gallery">
        		</tbody>
    			</table>
				</form>   	
				<div class="row-fluid">
					<div class="span12">
						<script id="template-upload" type="text/x-tmpl">
							{% for (var i=0, file; file=o.files[i]; i++) { %}
							    <tr class="template-upload fade">
							        <td class="preview"><span class="fade"></span></td>
							        <td class="name"><span>{%=file.name%}</span></td>
							        <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
							        {% if (file.error) { %}
							            <td class="error" colspan="2"><span class="label label-important">Error</span> {%=file.error%}</td>
							        {% } else if (o.files.valid && !i) { %}
							            <td>
							                <div class="progress progress-success progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"><div class="bar" style="width:0%;"></div></div>
							            </td>
							            <td class="start">{% if (!o.options.autoUpload) { %}
							                <button class="btn">
							                    <i class="icon-upload icon-white"></i>
							                    <span>Start</span>
							                </button>
							            {% } %}</td>
							        {% } else { %}
							            <td colspan="2"></td>
							        {% } %}
							        <td class="cancel">{% if (!i) { %}
							            <button class="btn red">
							                <i class="icon-ban-circle icon-white"></i>
							                <span>Cancel</span>
							            </button>
							        {% } %}</td>
							    </tr>
							{% } %}
						</script>
						<!-- The template to display files available for download -->
						<script id="template-download" type="text/x-tmpl">
							{% for (var i=0, file; file=o.files[i]; i++) { %}
							    <tr class="template-download fade">
							        {% if (file.error) { %}
							            <td></td>
							            <td class="name"><span>{%=file.name%}</span></td>
							            <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
							            <td class="error" colspan="2"><span class="label label-important">Error</span> {%=file.error%}</td>
							        {% } else { %}
							            <td class="preview">
							            {% if (file.thumbnail_url) { %}
							                <a class="fancybox-button" data-rel="fancybox-button" href="{%=file.url%}" title="{%=file.name%}">
							                	<img src="{%=file.thumbnail_url%}">
							                </a>
							            {% } %}</td>
							            <td class="name">
							                <a href="{%=file.url%}" title="{%=file.name%}" data-gallery="{%=file.thumbnail_url&&'gallery'%}" download="{%=file.name%}">{%=file.name%}</a>
							            </td>
							            <td class="size"><span>{%=o.formatFileSize(file.size)%}</span></td>
							            <td colspan="2"></td>
							        {% } %}
							        <td class="delete">
							            <button class="btn red" data-type="{%=file.delete_type%}" data-url="{%=file.delete_url%}"{% if (file.delete_with_credentials) { %} data-xhr-fields='{"withCredentials":true}'{% } %}>
							                <i class="icon-trash icon-white"></i>
							                <span>Delete</span>
							            </button>
							            <input type="checkbox" class="fileupload-checkbox hide" name="delete" value="1">
							        </td>
							    </tr>
							{% } %}
						</script>
					</div>
				</div>
				
        	</div> <!--the portlet body's Row fluid end -->
		</div> <!--portlet-body end -->
	</div> <!--Portlet end -->

</body>
<script type="text/javascript">
function addImportDataEventHandler(){
  jQuery("#submitTransData").on("click",function(e){
    var postData = {};
    postData.trans_driver = jQuery("#trans_driver").val();
    postData.trans_license = jQuery("#trans_license").val();
    postData.trans_start_time = jQuery("#trans_start_time").val();
    postData.trans_end_time = jQuery("#trans_end_time").val();
    postData.trans_end_place = jQuery("#trans_end_place").val();
    postData.trans_start_place = jQuery("#trans_start_place").val();
    postData.action = "submitTransData";
    jQuery.ajax({
                type:"POST",
                url:"$!request.getContextPath()/Traceability/dataManager",
                data:postData, 
                success:function(data){
                    if(data == "success"){
                        alert("录入完成");
                    }else if(data == "fail"){
                        alert("发生为止错误，请联系管理员");
                    }
                },
                async:true            
    });
  });
  jQuery("#submitSaleData").on("click",function(e){
    var postData = {
    };
    postData.sale_time = jQuery("#sale_time").val();
    postData.sale_place = jQuery("#sale_place").val();
    postData.sale_market = jQuery("#sale_market").val();
    postData.sale_freezer_number = jQuery("#sale_freezer_number").val();
    postData.action = "submitSaleData";
    jQuery.ajax({
        type:"POST",
        url:"$!request.getContextPath()/Traceability/dataManager",
        data:postData, 
        success:function(data){
            if(data == "success"){
                alert("录入完成");
            }else if(data == "fail"){
                alert("发生为止错误，请联系管理员");
            }
        },
        async:true            
    });
  });
}
jQuery(function(jQuery){
	jQuery('#sale_datetimepicker').datetimepicker({
            language: 'pt-BR'
    });
    jQuery('#trans_datetimepicker1').datetimepicker({
            language: 'pt-BR'
    });
    jQuery('#trans_datetimepicker2').datetimepicker({
            language: 'pt-BR'
    });
	jQuery('#fileupload').fileupload({
     	url: '$!request.getContextPath()/upload'
    });

    addImportDataEventHandler();
});
</script>
</html>